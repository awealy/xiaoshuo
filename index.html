<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>同人文创作与分享平台 — 阅读器</title>
    <meta name="description" content="学校同人文创作与分享平台 — 现代化 Markdown 驱动的阅读器" />

    <!-- Tailwind via CDN (快速美观) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Marked (Markdown 渲染)、highlight.js (代码高亮)、Lunr (可选搜索) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/default.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/lib/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lunr/lunr.min.js"></script>

    <link rel="stylesheet" href="assets/styles.css" />
    <!-- 引入 Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
  </head>
  <body class="bg-gray-50 text-gray-900 antialiased">
    <header class="bg-white shadow-md sticky top-0 z-30">
      <div class="mx-auto max-w-5xl p-4 flex items-center justify-between gap-6">
        <a href="/" class="text-2xl font-semibold text-indigo-600">成都市教育科学研究院新都附属实验学校 同人文</a>
        <nav class="hidden md:flex gap-6 items-center">
          <a href="gx/login.html" class="text-gray-700 hover:text-indigo-600">登录</a>
          <a href="community.html" class="text-gray-700 hover:text-indigo-600">社区</a>
          <a href="lx/index.html" class="text-gray-700 hover:text-indigo-600">联系我们</a>
          <a href="#books" class="text-gray-700 hover:text-indigo-600">小说作品</a>
          <button id="toggle-theme" class="px-3 py-1 border rounded hover:bg-indigo-600 text-gray-700">夜间模式</button>
        </nav>
        <button id="open-menu" class="md:hidden text-xl text-gray-700">☰</button>
      </div>
    </header>

    <main class="mx-auto max-w-5xl p-6 grid grid-cols-1 md:grid-cols-[320px,1fr] gap-8">
      <!-- 左侧：书目目录 -->
      <aside id="toc" class="hidden md:block bg-white p-6 rounded shadow-lg">
        <h3 class="text-xl font-semibold mb-4">书库</h3>
        <input id="search" placeholder="搜索书名 / 章节" class="ml-2 px-4 py-2 border rounded w-72 text-sm text-gray-700" />
        <div id="books" class="space-y-4 mt-6 overflow-auto max-h-[60vh]"></div>
      </aside>

      <!-- 阅读器 -->
      <div id="user-info" class="mb-4">
        <!-- 用户信息将在此加载 -->
      </div>
      <article class="bg-white p-6 rounded-lg shadow-lg" id="reader">
        <div class="mb-6 flex items-center justify-between gap-6">
          <div>
            <h1 id="book-title" class="text-3xl font-bold">— 请选择一本小说 —</h1>
            <p id="chapter-title" class="text-md text-gray-500">章节</p>
          </div>
          <div class="flex items-center gap-4">
            <button id="prev-ch" class="px-4 py-2 border rounded-lg hover:bg-indigo-500 text-white">上一章</button>
            <button id="next-ch" class="px-4 py-2 border rounded-lg hover:bg-indigo-500 text-white">下一章</button>
          </div>
        </div>

        <div class="h-2 bg-gray-200 rounded mb-6">
          <div id="progress" class="h-2 bg-indigo-500 rounded w-0"></div>
        </div>

        <div class="prose max-w-none text-lg" id="content" style="min-height:40vh;">
          <p class="text-sm text-gray-400">加载章节中...</p>
        </div>

        <div class="mt-8 flex items-center justify-between">
          <div class="flex items-center gap-4">
            <label class="text-sm">字号</label>
            <button class="px-3 py-2 border rounded text-sm" id="dec-font">A-</button>
            <button class="px-3 py-2 border rounded text-sm" id="inc-font">A+</button>
            <button class="px-3 py-2 border rounded text-sm" id="toggle-wide">阅读模式</button>
          </div>
          <div>
            <button id="bookmark" class="px-4 py-2 border rounded-lg text-sm hover:bg-indigo-600 text-white">书签</button>
          </div>
        </div>

        <hr class="my-6" />
        <section id="comments" class="mt-6">
          <p class="text-gray-400">加载评论中...</p>
        </section>
      </article>
    </main>

    <footer class="mt-8 p-4 text-center text-sm text-gray-500">
      <a href="gx/index.html" class="text-gray-700 hover:text-indigo-600">更新日志</a>
      <p>© 2025 版权所有 | 设计：awealy & wyxrl & 鉞熙</p>
    </footer>

    <script src="assets/app.js"></script>
  </body>
</html>
